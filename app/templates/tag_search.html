{% extends "base.html" %}
{% block content %}
<h4>タグ検索</h4>
<form class="row g-3 mb-3" method="get" action="{{ url_for('search_by_tag') }}">
  <div class="col-auto">
    <input type="text" class="form-control" name="name" placeholder="tag name" value="{{ tag_name or '' }}">
  </div>
  <div class="col-auto">
    <button type="submit" class="btn btn-primary">検索</button>
  </div>
</form>

{% if tag_name %}
  <p class="text-muted">タグ: <code>#{{ tag_name }}</code> のメモ</p>
{% endif %}

{% if memos and memos|length > 0 %}
  <ul class="list-unstyled">
    {% for m in memos %}
    <li class="mb-3">
      <!-- ▼ 脆弱：ここで private でもスニペットが見えてしまう -->
      <a href="{{ url_for('memo_detail', mid=m.id) }}">
        {{ m.body[:80] }}{% if m.body|length > 80 %}…{% endif %}
      </a>
      <small class="text-muted d-block">
        {{ m.created_at }} / {{ m.visibility }} / user: {{ m.user_id }}
      </small>
    </li>
    {% endfor %}
  </ul>
{% elif tag_name %}
  <div class="alert alert-secondary">該当するメモは見つかりませんでした。</div>
{% endif %}
{% endblock %}
